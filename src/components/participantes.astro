---
export const prerender = false;
import Timer from "../components/timer.astro";
---

<!-- Cartel de fuera del juego -->
<div id="pp-locked" class="pp-locked" hidden>
  <div class="pp-locked__card">
    <h2>🚫 No estás dentro del juego</h2>
    <p>
      Cuando el organizador te añada al juego,
      esta página se activará automáticamente.
    </p>
  </div>
</div>

<!-- Contenido del participante (arranca oculto, se muestra si jugando=TRUE) -->
<section id="pp-root" class="pp-wrap" hidden>
  <!-- Título con el usuario logueado -->
  <h2 class="pp-title">
    Participante:
    <span class="turn-title" id="pp-user-name">—</span>
  </h2>

  <div class="pp-grid">
    <!-- Marcador -->
    <div class="pp-card">
      <h3 class="pp-h3">Marcador</h3>
      <table class="pp-table" aria-label="Marcador de jugadores">
        <thead>
          <tr><th>Jugador</th><th>Puntos</th></tr>
        </thead>
        <tbody id="pp-body"></tbody>
      </table>
    </div>

    <!-- Tu turno + botón + reloj -->
    <div class="pp-card pp-center">
      <h3 class="pp-h3">Tu turno</h3>

      <div class="turno" id="turno-box">
        <span class="turno__label">Turno de:</span>
        <span class="turno__name" data-turn-name>—</span>
        <span class="turno__mine" hidden>¡¡¡TU TURNO!!!</span>
      </div>

      <button id="pp-buzz" class="pp-btn">¡Pulsar!</button>
      <p id="pp-hint" class="pp-hint"></p>

      <div class="timer-slot"><Timer /></div>
    </div>
  </div>
</section>

<style>
/* ====== Cartel fuera del juego ====== */
.pp-locked{max-width:900px;margin:2rem auto;padding:0 1rem}
.pp-locked__card{
  background:#1e293b;border:1px solid #334155;border-radius:16px;
  box-shadow:0 8px 22px rgba(0,0,0,.4);padding:24px;text-align:center
}
.pp-locked__card h2{margin:0 0 .5rem;font-weight:800;color:#f87171}
.pp-locked__card p{margin:0;color:#cbd5e1}

/* ====== LAYOUT ====== */
.pp-wrap { max-width: 950px; margin: 2rem auto; padding: 0 1rem; }
.pp-title { text-align: center; font-size: 2rem; color: #f1f5f9; margin-bottom: 2rem; font-weight: 800; }
.pp-title .turn-title { margin-left: .5rem; color:#e2e8f0; letter-spacing:.4px; }

.pp-grid { display: grid; gap: 1.5rem; grid-template-columns: 2fr 1fr; }
@media (max-width: 860px) { .pp-grid { grid-template-columns: 1fr; } }

.pp-card { background: #0f172a; border-radius: 16px; border: 1px solid #1e293b; box-shadow: 0 6px 18px rgba(0,0,0,.45); padding: 1.5rem; }
.pp-center { display:flex; flex-direction:column; align-items:center; justify-content:center; text-align:center; }

.pp-h3 { margin-bottom: 1rem; color:#f8fafc; font-size:1.2rem; font-weight:700; }

/* ====== BOTONES / TEXTOS ====== */
.pp-btn{
  display:inline-flex; align-items:center; justify-content:center;
  background:#3b82f6; color:#fff; border:none; border-radius:12px;
  padding:1rem 1.5rem; font-weight:700; cursor:pointer; min-width:200px;
  box-shadow:0 6px 18px rgba(7,11,74,.25);
  transition: transform .15s ease, box-shadow .15s ease, background .15s ease;
}
.pp-btn:hover{ background:#2563eb; transform: translateY(-2px); }
.pp-btn:disabled{ opacity:.6; cursor:not-allowed; }

.pp-hint{ margin-top:1rem; color:#94a3b8; font-size:.95rem; }
.timer-slot{ margin-top:14px; }

.turno{ margin:6px 0 10px; font-weight:800; color:#f1f5f9; }
.turno__label{ opacity:.7; margin-right:.35rem; }
.turno__name{ letter-spacing:.5px; }

/* ====== TABLA “CARD ROWS” + PROGRESO ====== */
.pp-table {
  width: 100%;
  border-collapse: separate;
  border-spacing: 0 12px;
  text-align: center;
  background: transparent;
  font-size: 1rem;
}
.pp-table thead th {
  background: #1e293b; color: #e2e8f0; font-weight: 700;
  text-transform: uppercase; font-size: .95rem; letter-spacing: .5px;
  padding: 1rem; border-radius: 12px;
}
.pp-table tbody tr.pp-row { background: #0f172a; box-shadow: 0 6px 18px rgba(0,0,0,.5); }
.pp-table tbody tr.pp-row td { border-bottom: none; padding: 14px 16px; vertical-align: middle; }
.pp-table tbody tr.pp-row td:first-child { border-radius: 12px 0 0 12px; }
.pp-table tbody tr.pp-row td:last-child  { border-radius: 0 12px 12px 0; }
.pp-scorecell { min-width: 210px; }
.pp-points { font-weight: 800; text-align: right; margin-bottom: 6px; }
.pp-bar { height: 8px; background: #1e293b; border-radius: 999px; overflow: hidden; }
.pp-bar > span { display: block; height: 100%; width: 0; border-radius: inherit; background: linear-gradient(90deg, #60a5fa, #3b82f6); transition: width .35s ease; }
.pp-row.first .pp-bar > span { background: linear-gradient(90deg, #f59e0b, #fbbf24); }
.pp-table .empty{ text-align:center; color:#94a3b8; padding:1rem; font-style:italic; }
.pp-row.me { box-shadow: 0 10px 24px rgba(96,165,250,.35); outline: 2px solid rgba(59,130,246,.45); }
</style>

<!-- ====== COMPUERTA: mostrar/ocultar según 'jugando' ====== -->
<script>
  import("../scripts/participantes.js").then(mod => mod.initParticipantes());
</script>
